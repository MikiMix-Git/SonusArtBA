<!DOCTYPE html>
<html lang="hr">
<head>
<meta charset="UTF-8">
<title>Argon Audio Katalog</title>
<style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; }
    header { background: #222; color: #fff; padding: 1rem; text-align: center; }
    nav, .filters { background: #444; padding: 0.5rem; display: flex; gap: 0.5rem; flex-wrap: wrap; }
    nav button, .filters input, .filters select { padding: 0.5rem; border-radius: 4px; border: none; }
    nav button { background: #666; color: white; cursor: pointer; }
    nav button:hover { background: #999; }
    .filters input[type="number"] { width: 80px; }
    .catalog { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; padding: 1rem; }
    .product-card { background: white; border-radius: 6px; padding: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: flex; flex-direction: column; }
    .product-card img { max-width: 100%; height: auto; border-radius: 4px; }
    .compare-btn { margin-top: auto; padding: 0.5rem; background: #007acc; color: white; border: none; cursor: pointer; border-radius: 4px; }
    .compare-btn:hover { background: #005c99; }
    #compare-section { background: white; padding: 1rem; margin: 1rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); overflow-x: auto; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: center; }
    th { background: #eee; }
</style>
</head>
<body>

<header>
    <h1>Argon Audio – Katalog proizvoda</h1>
</header>

<nav id="category-nav"></nav>

<div class="filters">
    <input type="text" id="search" placeholder="Pretraga po nazivu...">
    <input type="number" id="min-price" placeholder="Min €">
    <input type="number" id="max-price" placeholder="Max €">
    <select id="feature-filter">
        <option value="">Sve karakteristike</option>
        <option value="Bluetooth">Bluetooth</option>
        <option value="Wi-Fi">Wi‑Fi</option>
        <option value="HDMI ARC">HDMI ARC</option>
        <option value="ANC">ANC</option>
    </select>
    <button onclick="applyFilters()">Primijeni filtere</button>
</div>

<section class="catalog" id="product-list"></section>

<section id="compare-section">
    <h2>Upoređivanje proizvoda</h2>
    <table id="compare-table">
        <thead></thead>
        <tbody></tbody>
    </table>
</section>

<script>
const JSON_URL = "https://raw.githubusercontent.com/MikiMix-Git/SonusArtBA/refs/heads/main/json/argon_audio_products_all_categories.json";

let allProducts = {};
let currentCategory = "";
let selectedForCompare = [];

fetch(JSON_URL)
  .then(res => res.json())
  .then(data => {
    allProducts = data;
    renderCategories(Object.keys(data));
    currentCategory = Object.keys(data)[0];
    renderProducts(currentCategory);
  });

function renderCategories(categories) {
    const nav = document.getElementById("category-nav");
    nav.innerHTML = "";
    categories.forEach(cat => {
        const btn = document.createElement("button");
        btn.textContent = cat;
        btn.onclick = () => { currentCategory = cat; renderProducts(cat); };
        nav.appendChild(btn);
    });
}

function renderProducts(category) {
    const list = document.getElementById("product-list");
    list.innerHTML = "";
    allProducts[category].forEach(prod => {
        const card = document.createElement("div");
        card.className = "product-card";
        card.innerHTML = `
            <img src="${prod.image || ''}" alt="${prod.name}">
            <h3>${prod.name}</h3>
            <p>${prod.shortDescription || ''}</p>
            <p><strong>Cijena:</strong> ${prod.price || '-'}</p>
            <ul>
                ${prod.features ? prod.features.map(f => `<li>${f}</li>`).join('') : ''}
            </ul>
            <button class="compare-btn">Uporedi</button>
        `;
        card.querySelector(".compare-btn").onclick = () => addToCompare(prod);
        list.appendChild(card);
    });
}

function addToCompare(product) {
    if (selectedForCompare.find(p => p.name === product.name)) return;
    selectedForCompare.push(product);
    renderCompareTable();
}

function renderCompareTable() {
    const tableHead = document.querySelector("#compare-table thead");
    const tableBody = document.querySelector("#compare-table tbody");

    if (selectedForCompare.length === 0) {
        tableHead.innerHTML = "";
        tableBody.innerHTML = "";
        return;
    }

    let headRow = "<tr><th>Specifikacija</th>";
    selectedForCompare.forEach(p => headRow += `<th>${p.name}</th>`);
    headRow += "</tr>";
    tableHead.innerHTML = headRow;

    const specs = ["Cijena", ...(new Set(selectedForCompare.flatMap(p => p.features || [])))];
    tableBody.innerHTML = specs.map(spec => {
        let row = `<tr><td>${spec}</td>`;
        selectedForCompare.forEach(p => {
            if (spec === "Cijena") row += `<td>${p.price || '-'}</td>`;
            else row += `<td>${p.features && p.features.includes(spec) ? "✔️" : "❌"}</td>`;
        });
        row += "</tr>";
        return row;
    }).join('');
}

function applyFilters() {
    const searchVal = document.getElementById("search").value.toLowerCase();
    const minPrice = parseFloat(document.getElementById("min-price").value) || 0;
    const maxPrice = parseFloat(document.getElementById("max-price").value) || Infinity;
    const feature = document.getElementById("feature-filter").value;

    const list = document.getElementById("product-list");
    list.innerHTML = "";
    allProducts[currentCategory]
        .filter(prod => 
            prod.name.toLowerCase().includes(searchVal) &&
            parseFloat(prod.price) >= minPrice &&
            parseFloat(prod.price) <= maxPrice &&
            (feature === "" || (prod.features && prod.features.includes(feature)))
        )
        .forEach(prod => {
            const card = document.createElement("div");
            card.className = "product-card";
            card.innerHTML = `
                <img src="${prod.image || ''}" alt="${prod.name}">
                <h3>${prod.name}</h3>
                <p>${prod.shortDescription || ''}</p>
                <p><strong>Cijena:</strong> ${prod.price || '-'}</p>
                <ul>${prod.features ? prod.features.map(f => `<li>${f}</li>`).join('') : ''}</ul>
                <button class="compare-btn">Uporedi</button>
            `;
            card.querySelector(".compare-btn").onclick = () => addToCompare(prod);
            list.appendChild(card);
        });
}
</script>

</body>
</html>
